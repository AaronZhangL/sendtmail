 sendtmail
# ------------
# Written by Nate Hardison
# Last updated 3/21/12
#
# Generates and sends emails based on a CSV template. Useful
# for Gmail and for sending customized attachments to each
# recipient.
#
# DEPENDENCIES:
# - Jinja2: http://jinja.pocoo.org/docs/ (easy_install Jinja2)
# - Python 2.7.1 or greater (only tested on 2.7.1)
#
# How to use:
#
# 1) Create a CSV "workfile" containing all of your email details.
#    Each row should contain header info (FROM, TO, CC, and BCC)
#    for a single recipient. BODY and SUBJECT are also required.
# 2) BODY should be a path (absolute or relative to the location
#    of the CSV workfile) to a template file that uses Jinja2
#    templating syntax (see http://jinja.pocoo.org/docs/templates/
#    for details). Each row can have a different value for BODY
#    if you want.
# 3) SUBJECT should just be a string in the CSV, though it can
#    also use Jinja2 template syntax.
# 4) If there is a field called ATTACHMENT in the CSV, it should
#    point to a file to attach to the email (absolute or relative
#    path just like BODY). Right now this script only supports one
#    attachment.
# 5) You also need to create a file containing the details
#    of the account to which you want to connect. This file
#    needs to have 3 lines, with the SMTP host and port on 
#    the first, the user account on the second, and the account
#    password on the third.
# 6) Run sendtmail <workfile> <account file> to use. If you set
#    --debug=True, then sendtmail will print out all of your 
#    templatized emails, which is super handy to make sure you
#    didn't screw anything up.